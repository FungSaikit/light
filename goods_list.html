<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>商品列表</title>

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="./CSS/good_list.css">
    <link rel="stylesheet" href="./CSS/hr.css">

    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }

        body {
            background-color: #eeeeee;
        }

        .topbar {
            height: 3em;
            background-color: #fff;
            border-bottom: 1px solid darkgray;
            text-align: center;
            position: fixed;
            top: 0;
            width: 100%;
        }

        .topbar_left {
            height: 60%;
            float: left;
            padding-left: 1.5em;
            margin-top: 0.6em;
        }

        .topbar_right {
            height: 60%;
            float: right;
            padding-right: 1.5em;
            margin-top: 0.6em;
        }

        .topbar_middle {
            display: inline-block;
            font-size: 1.5em;
            line-height: 2em;
            vertical-align: middle;
        }

        .placeholder {
            height: 3em;
        }

        .goods_info_div {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1;
            background-color: rgba(0, 0, 0, 0.8);
        }

        .blankzone {
            height: 10%;
        }

        .content {
            background-color: #fff;
            width: 100%;
            height: 90%;
        }

        .title_table {
            width: 100%;
        }

        .content_spec_title {
            width: 96%;
            margin: 0 2%;
            color: #434343;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            vertical-align: middle;
        }

        .content_spec_price {
            color: #ee7a00;
            font-size: 1.2em;
        }

        .content_spec_salenumber {
            color: #9f9f9f;
            text-align: right;
        }

        .title_img {
            height: 20%;

        }

        .cart_button {
            height: 3em;
        }

        .content_menu {
            width: 100%;
            height: 15%;
            text-align: center;
            position: fixed;
            bottom: 0;
            line-height: 100%;
            vertical-align: middle;
        }

        .content_menu table {
            width: 100%;
        }

        .menu_left {
            width: 25%;
        }

        .menu_middle {
            width: 50%;
        }

        .menu_right {
            width: 25%;
        }

        .content_bottom_a {
            display: inline-block;
            height: 2em;
            width: 90%;
            border: 1px solid lightgray;
            background-color: lightgray;
            border-radius: 1em;
            line-height: 2em;
            vertical-align: middle;
        }

        .table_div {
            height: 60%;
            width: 96%;
            border: 1px solid #9f9f9f;
            margin: 2% auto;
            border-radius: 0.3em;
        }

        .spec_table {
            border-collapse: collapse;
            width: 96%;
            height: 96%;
            margin: 2%;
        }

        .spec_line {
            border-bottom: 1px solid #f5f5f5;
            width: 100%;
        }

        .spec_title {
            width: 9em;
            text-align: right;
        }

        .spec_content {
            text-align: left;
        }

        .glance_pic {
            width: 100%;
        }

        .glance_img {
            width: 96%;
            margin: 2%;
        }

        .glance_model {
            width: 96%;
            margin: 0 2%;
            color: #999;
            font-size: 0.8em;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
            vertical-align: middle;
        }

        #box1 {
            position: relative;
        }

        #box2 {
            position: relative;
        }

    </style>

</head>

<body>

<div class="topbar">
    <a href="#"><img class="topbar_left" src="./IMG/top_bar/back.png" alt="返回"></a>
    <span class="topbar_middle">商品列表</span>
    <a href="#"><img class="topbar_right" src="./IMG/top_bar/cart.png" alt="购物车"></a>
</div>

<div class="placeholder">
    <!--人家真的只是用来占位置的啦-->
</div>

<div class="recommend">
    <!--推荐商品-->
    <div class="recommendgoods">
        <a href="javascript:void(0)" onclick="showDetails()">
            <img src="./IMG/play_list/img2.png" class="goods_pic">
            <br>
            <div class="goodstitle">
                <span class="goodstitle_span">
                松下（Panasonic）HHLA1630CB LED灯吸顶灯客厅卧室灯具 19W素白 哈哈哈哈哈哈哈
                </span>
            </div>
            <div class="goodsdetail">
                <span class="goodsmodel">型号: GY8801/左</span>
                <br>
                <span class="goodsspec">规格: 左边款/壁灯</span>
            </div>
        </a>
        <div class="goodsprice">
            <span>￥ 150</span>
            <img href="javascript:void(0)" onclick="cart()" class="cartpic" src="./IMG/recommend/cart.png">
        </div>
    </div>

    <!--推荐商品-->
    <span class="recommend_title">———— 没有更多啦 ————</span>
</div>

<div id="detailBox" class="goods_info_div" hidden>
    <div class="blankzone"></div>
    <div class="content" id="box1">
        <div class="glance_pic">
            <img class="glance_img" src="./IMG/light/1-ferric.png">
        </div>
        <div class="glancetable">
            <table>
                <tr>
                    <td id="line1"><span class="content_spec_title">我是不超过两行的标题我是不超过两行的标题我是不超过两行的标题我是不超过两行的标题我是不超过两行的标题我是不超过两行的标题我是不超过两行的标题</span>
                    </td>
                </tr>
                <tr>
                    <td id="line2">
                        <span class="glance_model">型号：我是型号我不超过一行我是型号我不超过一行我是型号我不超过一行我是型号我不超过一行我是型号我不超过一行</span></td>
                </tr>
                <tr>
                    <table id="line3" style="width: 96%; margin: 0 2%;">
                        <tr>
                            <td class="content_spec_price">￥<span>888</span></td>
                            <td class="content_spec_salenumber">销量 <span>888</span></td>
                        </tr>
                    </table>
                </tr>
            </table>
        </div>
    </div>
    <div class="content" id="box2">
        <div class="content_title">
            <table class="title_table">
                <tr>
                    <td><img class="title_img" src="./IMG/light/1-ferric.png"></td>
                    <td>
                        <table>
                            <tr>
                                <td class="content_spec_title">
                                    我是不超过两行的标题我是不超过两行的标题我是不超过两行的标题我是不超过两行的标题我是不超过两行的标题我是不超过两行的标题
                                </td>
                            </tr>

                            <tr>
                                <table style="width: 100%;">
                                    <tr style="width: 100%;">
                                        <td class="content_spec_price">￥88</td>
                                        <td class="content_spec_salenumber">销量<span>1688</span></td>
                                    </tr>
                                </table>
                            </tr>
                        </table>
                    </td>
                </tr>

            </table>
        </div>

        <hr>

        <div class="table_div">
            <table class="spec_table">
                <tr class="spec_line">
                    <th class="spec_title">产品规格(mm/cm):</th>
                    <td class="spec_content"></td>
                </tr>
                <tr class="spec_line">
                    <th class="spec_title">包装规格(mm/cm):</th>
                    <td class="spec_content"></td>
                </tr>
                <tr class="spec_line">
                    <th class="spec_title">适用空间:</th>
                    <td class="spec_content"></td>
                </tr>
                <tr class="spec_line">
                    <th class="spec_title">产品材质:</th>
                    <td class="spec_content"></td>
                </tr>
                <tr class="spec_line">
                    <th class="spec_title">光源类型:</th>
                    <td class="spec_content"></td>
                </tr>
                <tr class="spec_line">
                    <th class="spec_title">光源说明:</th>
                    <td class="spec_content"></td>
                </tr>
                <tr class="spec_line">
                    <th class="spec_title">功率(自带光源):</th>
                    <td class="spec_content"></td>
                </tr>
            </table>
        </div>

        <div class="content_menu" style="background-color: #FFFFFF">

            <div class="hr">
                <div class="cell"></div>
                <div class="hr_title">上拉查看更多详情</div>
                <div class="cell"></div>
            </div>

            <table>
                <tr>
                    <td class="menu_left">
                        <a class="content_bottom_a" href="javascript:void(0)" onclick="closeDetails()">关闭</a>
                    </td>
                    <td class="menu_middle">
                        <a href="#"><img class="cart_button" src="IMG/cart/0.jpeg" alt=""></a><a href="#"><img
                            class="cart_button" src="./IMG/cart/1.jpeg" alt=""></a><a href="#"><img class="cart_button"
                                                                                                    src="IMG/cart/2.jpeg"
                                                                                                    alt=""></a>
                    </td>
                    <td class="menu_right">
                        <a class="content_bottom_a">查看详情</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>

<script type="text/javascript">
    var status = 0;
    /*状态：0为产品列表 1为商品页1 2为商品页2*/
    var body = document.getElementsByTagName("body")[0];
    var goods = document.getElementsByClassName("recommendgoods");
    var goodsDetail = document.getElementsByClassName("goods_info_div")[0];
    var cartButton = document.getElementsByClassName("cart_button");
    var bigPicture = document.getElementsByClassName("glance_img")[0];
    var line2 = document.getElementById("line2");
    var line3 = document.getElementById("line3");
    var detailBox = document.getElementById("detailBox");
    var box1 = document.getElementById("box1");
    var box2 = document.getElementById("box2");

    var deviceWidth = document.documentElement ? document.documentElement.clientWidth : document.body.clientWidth;
    var deviceHeight = document.documentElement ? document.documentElement.clientHeight : document.body.clientHeight;

    window.onload = function () {
        /*设置商品列表高度*/
        for (var i = 0; i < goods.length; i++) {
            goods[i].style.height = (goods[0].clientWidth / 3 * 5) + "px";
        }

        /*设置detail的高度*/
        goodsDetail.style.height = (document.documentElement ? document.documentElement.clientHeight : document.body.clientHeight) + "px";
        /*设置cart按钮的高度*/
        if (deviceWidth >= 360) {
            for (var i = 0; i < cartButton.length; i++) {
                cartButton[i].style.height = "4em";
            }
            cartButton[0].style.width = cartButton[0].clientHidth / 190 * 138 + "px";
            cartButton[1].style.width = cartButton[1].clientHidth / 190 * 208 + "px";
            cartButton[2].style.width = cartButton[2].clientHidth / 190 * 140 + "px";
        }

        /*将box2隐藏到下面位置*/
        box2.style.top = "100%";
    }

    function cart() {
        alert("添加购物车成功！");
    }

    function showDetails() {
        /*禁止滑动*/
        body.style.overflow = "hidden";
        body.style.height = "100%";
        /*显示detailBox*/
        detailBox.hidden = false;
        /*修改detailBox中的样式*/
        bigPicture.style.height = bigPicture.clientWidth + "px";
        line2.style.height = 0.05 * deviceHeight + "px";
        line3.style.height = 0.05 * deviceHeight + "px";
        status = 1;
    }

    function showBox2() {
        box1.hidden = true;
        status = 2;
        box2Movement();
    }

    function box2Movement() {
        var boxTop = parseInt(box2.style.top);
        console.log(boxTop);
        if (boxTop == 0) {
            return false;
        }
        if (boxTop > 0) {
            boxTop-=2;
        } else if (boxTop < 0) {
            boxTop+=2;
        }
        box2.style.top = boxTop + "%";
        setTimeout(box2Movement, 1);
    }

    function closeDetails() {
        detailBox.hidden = true;
        status = 0;
        box1.hidden = false;
        box2.style.top = "100%";
    }
</script>

<script type="text/javascript">
    /*touch function*/
    var touch = {
        x: 0,
        y: 0
    }
    box1.addEventListener("touchstart", touchbox1, false);
    box1.addEventListener("touchend", touchbox1, false);
    box1.addEventListener("touchmove", touchbox1, false);

    box2.addEventListener("touchstart", touchbox2, false);
    box2.addEventListener("touchend", touchbox2, false);
    box2.addEventListener("touchmove", touchbox2, false);



    function touchbox1(event) {
        var startTouch = event.touches[0];
        var endTouch = event.changedTouches[0];
        switch (event.type) {
            case "touchstart":
                touch.x = startTouch.clientX;
                touch.y = startTouch.clientY;
                break;
            case "touchmove":
                var yOffset = touch.y - startTouch.clientY
                box1.style.bottom = yOffset + "px";
                break;
            case "touchend":
                var xMove = Math.abs(endTouch.clientX - touch.x);
                var yMove = Math.abs(endTouch.clientY - touch.y);
                if (xMove < yMove && endTouch.clientY < touch.y) {
                    box1.style.bottom = "0px";
                    showBox2();
                } else {
                    box1.style.bottom = "0px";
                }
                break;
            default:
                break;
        }
    }

    function touchbox2(event) {
        var startTouch = event.touches[0];
        var endTouch = event.changedTouches[0];
        switch (event.type) {
            case "touchstart":
                touch.x = startTouch.clientX;
                touch.y = startTouch.clientY;
                break;
            case "touchmove":
                var yOffset = touch.y - startTouch.clientY;
                box2.style.top = -yOffset + "px";
                break;
            case "touchend":
                var xMove = Math.abs(endTouch.clientX - touch.x);
                var yMove = Math.abs(endTouch.clientY - touch.y);
                if (xMove < yMove && endTouch.clientY < touch.y) {//如果是向上滑动
                    box2.style.top = "0%";
                } else if (xMove < yMove && endTouch.clientY > touch.y) {//如果是向下滑动
                    box2.style.top = "100%";
                    box1.hidden = false;
                    status = 1;
                }
                break;
            default:
                break;
        }
    }

</script>

</body>
</html>